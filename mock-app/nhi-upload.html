<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¥ä¿ä¸Šå‚³ - TWPAS</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: #f0f2f5; }
    .header { background: linear-gradient(135deg, #1a73e8, #0d47a1); color: white; padding: 0 1.5rem; height: 60px; display: flex; justify-content: space-between; align-items: center; position: fixed; top: 0; left: 0; right: 0; z-index: 100; }
    .header h1 { font-size: 1.25rem; }
    .sidebar { position: fixed; left: 0; top: 60px; bottom: 0; width: 240px; background: white; border-right: 1px solid #e0e0e0; }
    .sidebar-menu { list-style: none; padding: 0.5rem 0; }
    .sidebar-menu li a { display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1.25rem; color: #333; text-decoration: none; border-left: 3px solid transparent; }
    .sidebar-menu li a:hover { background: #f5f5f5; }
    .sidebar-menu li a.active { background: #e3f2fd; color: #1a73e8; border-left-color: #1a73e8; }
    .menu-divider { height: 1px; background: #e0e0e0; margin: 0.5rem 1rem; }
    .menu-label { padding: 0.75rem 1.25rem 0.5rem; font-size: 0.75rem; color: #888; }
    .main { margin-left: 240px; margin-top: 60px; padding: 1.5rem; }
    .page-header { margin-bottom: 1.5rem; }
    .page-header h2 { font-size: 1.5rem; color: #333; }
    .alert { padding: 1rem; border-radius: 8px; margin-bottom: 1rem; }
    .alert-info { background: #e3f2fd; color: #1565c0; border: 1px solid #90caf9; }
    .card { background: white; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 1rem; }
    .card-header { padding: 1rem 1.5rem; border-bottom: 1px solid #eee; font-weight: 600; }
    .card-body { padding: 1.5rem; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 0.6rem 1rem; text-align: left; border-bottom: 1px solid #eee; }
    th { background: #fafafa; font-size: 0.85rem; color: #666; }
    .status-ready { color: #4caf50; }
    .status-uploaded { color: #1a73e8; }
    .status-error { color: #f44336; }
    .btn { padding: 0.4rem 0.8rem; border-radius: 4px; cursor: pointer; border: none; font-size: 0.85rem; }
    .btn-upload { background: #4caf50; color: white; }
    .btn-view { background: #e3f2fd; color: #1565c0; }
    .progress-bar { height: 20px; background: #e0e0e0; border-radius: 10px; overflow: hidden; margin-top: 1rem; }
    .progress-fill { height: 100%; background: linear-gradient(90deg, #4caf50, #8bc34a); transition: width 0.3s; }
    .upload-stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 1rem; }
    .stat-item { text-align: center; padding: 1rem; background: #fafafa; border-radius: 8px; }
    .stat-value { font-size: 1.5rem; font-weight: 600; color: #1a73e8; }
    .stat-label { font-size: 0.85rem; color: #666; }
    .header-right { display: flex; align-items: center; gap: 1rem; }
    .logout-btn { background: rgba(255,255,255,0.15); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 0.4rem 1rem; border-radius: 4px; cursor: pointer; }
  </style>
</head>
<body>
  <header class="header">
    <h1>ğŸ¥ TWPAS ç™Œç—‡ç”¨è—¥äº‹å‰å¯©æŸ¥ç³»çµ±</h1>
    <div class="header-right">
      <span id="username-display"></span>
      <button class="logout-btn" onclick="logout()">ç™»å‡º</button>
    </div>
  </header>

  <nav class="sidebar">
    <ul class="sidebar-menu">
      <li><a href="/dashboard"><span>ğŸ“Š</span> å„€è¡¨æ¿</a></li>
      <div class="menu-divider"></div>
      <div class="menu-label">æ¡ˆä»¶ç®¡ç†</div>
      <li><a href="/claim/new"><span>â•</span> æ–°å¢ç”³è«‹</a></li>
      <li><a href="/claim"><span>ğŸ“‹</span> æ¡ˆä»¶åˆ—è¡¨</a></li>
      <div class="menu-divider"></div>
      <div class="menu-label">è³‡æ–™ç®¡ç†</div>
      <li><a href="/patient"><span>ğŸ‘¤</span> ç—…æ‚£è³‡æ–™</a></li>
      <li><a href="/valueset"><span>ğŸ“š</span> å€¼é›†ç®¡ç†</a></li>
      <div class="menu-divider"></div>
      <div class="menu-label">ç³»çµ±åŠŸèƒ½</div>
      <li><a href="/fhir"><span>ğŸ”„</span> FHIR è½‰æ›</a></li>
      <li><a href="/nhi-upload" class="active"><span>â˜ï¸</span> å¥ä¿ä¸Šå‚³</a></li>
    </ul>
  </nav>

  <main class="main">
    <div class="page-header">
      <h2>â˜ï¸ å¥ä¿ç½²ä¸Šå‚³ä½œæ¥­</h2>
    </div>

    <div class="alert alert-info">
      â„¹ï¸ æ­¤åŠŸèƒ½å°‡æ¡ˆä»¶è³‡æ–™è½‰æ›ç‚º FHIR æ ¼å¼ä¸¦ä¸Šå‚³è‡³å¥ä¿ç½²äº‹å‰å¯©æŸ¥å¹³å°ã€‚è«‹ç¢ºèªæ¡ˆä»¶è³‡æ–™å®Œæ•´å¾Œå†é€²è¡Œä¸Šå‚³ã€‚
    </div>

    <div class="upload-stats">
      <div class="stat-item">
        <div class="stat-value">5</div>
        <div class="stat-label">å¾…ä¸Šå‚³</div>
      </div>
      <div class="stat-item">
        <div class="stat-value">12</div>
        <div class="stat-label">å·²ä¸Šå‚³</div>
      </div>
      <div class="stat-item">
        <div class="stat-value">8</div>
        <div class="stat-label">å¯©æ ¸ä¸­</div>
      </div>
      <div class="stat-item">
        <div class="stat-value">3</div>
        <div class="stat-label">å·²æ ¸å‡†</div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">å¾…ä¸Šå‚³æ¡ˆä»¶</div>
      <div class="card-body">
        <table>
          <thead>
            <tr>
              <th><input type="checkbox" id="select-all"></th>
              <th>æ¡ˆä»¶ç·¨è™Ÿ</th>
              <th>ç—…æ‚£å§“å</th>
              <th>è—¥ç‰©</th>
              <th>ç‹€æ…‹</th>
              <th>æ“ä½œ</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><input type="checkbox"></td>
              <td>CL-2026-0002</td>
              <td>æâ—‹è¯</td>
              <td>Nivolumab</td>
              <td><span class="status-ready">âœ“ æº–å‚™å°±ç·’</span></td>
              <td><button class="btn btn-upload" onclick="uploadCase('CL-2026-0002')">ä¸Šå‚³</button></td>
            </tr>
            <tr>
              <td><input type="checkbox"></td>
              <td>CL-2026-0008</td>
              <td>è”¡â—‹èŠ¬</td>
              <td>Cetuximab</td>
              <td><span class="status-ready">âœ“ æº–å‚™å°±ç·’</span></td>
              <td><button class="btn btn-upload" onclick="uploadCase('CL-2026-0008')">ä¸Šå‚³</button></td>
            </tr>
          </tbody>
        </table>
        <div style="margin-top: 1rem;">
          <button class="btn btn-upload" onclick="uploadSelected()">ğŸ“¤ æ‰¹æ¬¡ä¸Šå‚³é¸å–é …ç›®</button>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">æœ€è¿‘ä¸Šå‚³ç´€éŒ„</div>
      <div class="card-body">
        <table>
          <thead>
            <tr>
              <th>æ¡ˆä»¶ç·¨è™Ÿ</th>
              <th>ä¸Šå‚³æ™‚é–“</th>
              <th>æ”¶ä»¶ç·¨è™Ÿ</th>
              <th>ç‹€æ…‹</th>
              <th>æ“ä½œ</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>CL-2026-0003</td>
              <td>2026-02-01 15:30</td>
              <td>NHI-2026020112345</td>
              <td><span class="status-uploaded">å¯©æ ¸ä¸­</span></td>
              <td><button class="btn btn-view">æŸ¥è©¢é€²åº¦</button></td>
            </tr>
            <tr>
              <td>CL-2026-0004</td>
              <td>2026-01-28 10:15</td>
              <td>NHI-2026012854321</td>
              <td><span class="status-ready">å·²æ ¸å‡†</span></td>
              <td><button class="btn btn-view">æŸ¥çœ‹çµæœ</button></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </main>

  <script>
    function uploadCase(caseNumber) {
      if (confirm('ç¢ºå®šè¦ä¸Šå‚³æ¡ˆä»¶ ' + caseNumber + ' å—ï¼Ÿ')) {
        alert('ä¸Šå‚³æˆåŠŸï¼\n\næ”¶ä»¶ç·¨è™Ÿï¼šNHI-' + Date.now());
      }
    }

    function uploadSelected() {
      alert('æ‰¹æ¬¡ä¸Šå‚³åŠŸèƒ½é–‹ç™¼ä¸­...');
    }

    function getCookie(name) {
      const value = '; ' + document.cookie;
      const parts = value.split('; ' + name + '=');
      if (parts.length === 2) return parts.pop().split(';').shift();
      return null;
    }
    if (!getCookie('twpas_auth')) window.location.href = '/login?expired=true';
    else {
      const user = JSON.parse(sessionStorage.getItem('user') || '{}');
      document.getElementById('username-display').textContent = user.username || '';
    }
    function logout() {
      sessionStorage.clear();
      document.cookie = 'twpas_auth=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT';
      window.location.href = '/login';
    }
  </script>
</body>
</html>
