# language: zh-TW
@auth @profile
功能: 個人資料管理
  作為一個系統使用者
  我想要能夠查看和管理我的個人資料
  以便維護帳號資訊和常用範本

  背景:
    假設 我已經登入為 "TWPASTWPAS"

  # =============================================================================
  # 個人資料頁面結構
  # =============================================================================

  @page-structure
  場景: 顯示個人資料頁面
    當 我在個人資料頁面
    那麼 我應該看到頁面標題 "個人資料"
    並且 我應該看到基本資料區塊
    並且 我應該看到變更密碼區塊
    並且 我應該看到申請案常用病歷摘要範本區塊

  場景: 顯示基本資料欄位
    當 我在個人資料頁面
    那麼 基本資料區塊應該顯示以下欄位:
      | 欄位         |
      | 帳號         |
      | 科別         |
      | 姓名         |
      | 隸屬醫師     |
      | 生日         |
      | 醫師代碼     |
      | 身分證字號   |
      | 職稱         |
      | 聯絡電話     |
      | 信箱         |

  場景: 基本資料顯示目前登入使用者資訊
    當 我在個人資料頁面
    那麼 帳號應該顯示 "TWPASTWPAS"
    並且 科別應該顯示 "乳癌"
    並且 姓名應該顯示 "洪主任"

  # =============================================================================
  # 變更密碼
  # =============================================================================

  @change-password
  場景: 顯示變更密碼區塊
    當 我在個人資料頁面
    那麼 我應該看到 "是否需更新密碼?" 區塊
    並且 我應該看到 "變更密碼" 按鈕

  場景: 點擊變更密碼按鈕
    當 我在個人資料頁面
    並且 我點擊 "變更密碼" 按鈕
    那麼 我應該看到變更密碼表單

  場景: 成功變更密碼
    當 我在變更密碼表單
    並且 我填寫目前密碼為 "TWPASTWPAS"
    並且 我填寫新密碼為 "NewPass1234!"
    並且 我填寫確認新密碼為 "NewPass1234!"
    並且 我點擊確認按鈕
    那麼 我應該看到成功訊息 "密碼已更新"

  場景: 變更密碼時目前密碼錯誤
    當 我在變更密碼表單
    並且 我填寫目前密碼為 "WrongPassword"
    並且 我填寫新密碼為 "NewPass1234!"
    並且 我填寫確認新密碼為 "NewPass1234!"
    並且 我點擊確認按鈕
    那麼 我應該看到錯誤訊息 "目前密碼不正確"

  場景: 變更密碼時確認密碼不符
    當 我在變更密碼表單
    並且 我填寫目前密碼為 "TWPASTWPAS"
    並且 我填寫新密碼為 "NewPass1234!"
    並且 我填寫確認新密碼為 "DifferentPass!"
    並且 我點擊確認按鈕
    那麼 我應該看到錯誤訊息 "新密碼與確認密碼不符"

  場景: 變更密碼時新密碼強度不足
    當 我在變更密碼表單
    並且 我填寫目前密碼為 "TWPASTWPAS"
    並且 我填寫新密碼為 "weak"
    並且 我填寫確認新密碼為 "weak"
    並且 我點擊確認按鈕
    那麼 我應該看到錯誤訊息提示密碼強度不足

  # =============================================================================
  # 病歷摘要範本管理
  # =============================================================================

  @medical-summary-template
  場景: 顯示病歷摘要範本區塊
    當 我在個人資料頁面
    那麼 我應該看到 "申請案常用病歷摘要範本" 區塊
    並且 我應該看到 "治療過程" 標籤頁

  場景: 顯示範本列表
    當 我在個人資料頁面的病歷摘要範本區塊
    那麼 我應該看到範本表格包含以下欄位:
      | 欄位       |
      | 範本名稱   |
      | 範本內文   |
      | 建立日期   |

  場景: 新增病歷摘要範本
    當 我在個人資料頁面的病歷摘要範本區塊
    並且 我點擊 "加入文本" 按鈕
    那麼 我應該看到新增範本表單

  場景: 成功新增病歷摘要範本
    當 我在新增範本表單
    並且 我填寫範本名稱為 "常用病歷摘要"
    並且 我填寫範本內文為 "Patient diagnosed with..."
    並且 我點擊儲存按鈕
    那麼 我應該看到成功訊息 "範本已新增"
    並且 範本列表應該包含 "常用病歷摘要"

  場景: 編輯病歷摘要範本
    假設 我已有一個名為 "常用病歷摘要" 的範本
    當 我在範本列表點擊該範本的編輯按鈕
    並且 我修改範本內文
    並且 我點擊儲存按鈕
    那麼 我應該看到成功訊息 "範本已更新"

  場景: 刪除病歷摘要範本
    假設 我已有一個名為 "常用病歷摘要" 的範本
    當 我在範本列表點擊該範本的刪除按鈕
    並且 我確認刪除操作
    那麼 我應該看到成功訊息 "範本已刪除"
    並且 範本列表不應該包含 "常用病歷摘要"

  場景: 新增範本時範本名稱為必填
    當 我在新增範本表單
    並且 我只填寫範本內文
    並且 我點擊儲存按鈕
    那麼 我應該看到錯誤訊息 "範本名稱為必填"

  # =============================================================================
  # 導航
  # =============================================================================

  @navigation
  場景: 從側邊選單進入個人資料頁面
    當 我在任何已登入的頁面
    並且 我點擊側邊選單的 "個人資料" 連結
    那麼 我應該被導向個人資料頁面

  場景: 登入後預設顯示個人資料頁面
    當 我成功登入
    那麼 我應該被導向個人資料頁面
