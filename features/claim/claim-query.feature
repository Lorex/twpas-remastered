# language: zh-TW
@claim @query
功能: 申報案件查詢
  作為一個醫療人員
  我想要能夠依據多種條件查詢申報案件
  以便快速找到需要處理的案件

  背景:
    假設 我已經登入為 "doctor01"
    並且 資料庫中存在以下申報案件:
      | 案件編號   | 病人   | 申報類別 | 案件類別     | 狀態   | 建立日期   |
      | CASE-001   | 王小明 | 新申請   | 癌症標靶治療 | 草稿   | 2024-01-15 |
      | CASE-002   | 王小明 | 續用申請 | 癌症標靶治療 | 待審核 | 2024-02-01 |
      | CASE-003   | 李小華 | 新申請   | 癌症免疫治療 | 核准   | 2024-01-20 |
      | CASE-004   | 張大同 | 新申請   | 癌症化學治療 | 駁回   | 2024-01-25 |
      | CASE-005   | 陳美玲 | 劑量調整 | 癌症標靶治療 | 草稿   | 2024-02-10 |

  # =============================================================================
  # 基本查詢
  # =============================================================================

  @basic-query
  場景: 依案件編號精確查詢
    當 我在案件列表頁面
    並且 我在搜尋欄輸入案件編號 "CASE-001"
    並且 我點擊搜尋按鈕
    那麼 查詢結果應該只有 1 筆
    並且 結果應該包含案件 "CASE-001"

  場景: 依案件編號部分查詢
    當 我在案件列表頁面
    並且 我在搜尋欄輸入 "CASE-00"
    並且 我點擊搜尋按鈕
    那麼 查詢結果應該包含所有以 "CASE-00" 開頭的案件

  場景: 依申報類別篩選
    當 我在案件列表頁面
    並且 我選擇申報類別篩選為 "新申請"
    那麼 查詢結果應該只包含申報類別為 "新申請" 的案件
    並且 查詢結果應該包含 3 筆案件

  場景: 依案件類別篩選
    當 我在案件列表頁面
    並且 我選擇案件類別篩選為 "癌症標靶治療"
    那麼 查詢結果應該只包含案件類別為 "癌症標靶治療" 的案件
    並且 查詢結果應該包含案件 "CASE-001", "CASE-002", "CASE-005"

  場景: 依狀態篩選
    當 我在案件列表頁面
    並且 我選擇狀態篩選為 "草稿"
    那麼 查詢結果應該只包含狀態為 "草稿" 的案件
    並且 查詢結果應該包含案件 "CASE-001", "CASE-005"

  # =============================================================================
  # 複合條件查詢
  # =============================================================================

  @compound-query
  場景: 依申報類別和案件類別複合查詢
    當 我在案件列表頁面
    並且 我選擇申報類別篩選為 "新申請"
    並且 我選擇案件類別篩選為 "癌症標靶治療"
    那麼 查詢結果應該只包含同時符合兩個條件的案件
    並且 查詢結果應該只包含案件 "CASE-001"

  場景: 依病人和狀態複合查詢
    當 我在案件列表頁面
    並且 我選擇病人篩選為 "王小明"
    並且 我選擇狀態篩選為 "草稿"
    那麼 查詢結果應該只包含案件 "CASE-001"

  場景: 三個條件複合查詢
    當 我在案件列表頁面
    並且 我設定以下查詢條件:
      | 條件       | 值           |
      | 申報類別   | 新申請       |
      | 案件類別   | 癌症標靶治療 |
      | 狀態       | 草稿         |
    並且 我點擊搜尋按鈕
    那麼 查詢結果應該只包含案件 "CASE-001"

  # =============================================================================
  # 日期範圍查詢
  # =============================================================================

  @date-query
  場景: 依建立日期範圍查詢
    當 我在案件列表頁面
    並且 我設定建立日期範圍為 "2024-01-15" 到 "2024-01-25"
    並且 我點擊搜尋按鈕
    那麼 查詢結果應該包含案件 "CASE-001", "CASE-003", "CASE-004"
    並且 查詢結果不應該包含案件 "CASE-002", "CASE-005"

  場景: 依建立日期起始查詢
    當 我在案件列表頁面
    並且 我設定建立日期起始為 "2024-02-01"
    並且 我點擊搜尋按鈕
    那麼 查詢結果應該只包含建立日期在 2024-02-01 之後的案件

  # =============================================================================
  # 排序與分頁
  # =============================================================================

  @sorting
  場景: 依建立日期排序
    當 我在案件列表頁面
    並且 我點擊 "建立日期" 欄位標題
    那麼 案件應該依建立日期降序排列
    當 我再次點擊 "建立日期" 欄位標題
    那麼 案件應該依建立日期升序排列

  場景: 依案件編號排序
    當 我在案件列表頁面
    並且 我點擊 "案件編號" 欄位標題
    那麼 案件應該依案件編號排序

  場景: 依狀態排序
    當 我在案件列表頁面
    並且 我點擊 "狀態" 欄位標題
    那麼 案件應該依狀態排序

  @pagination
  場景: 分頁顯示查詢結果
    假設 資料庫中存在 50 筆申報案件
    當 我在案件列表頁面
    那麼 預設應該顯示 20 筆案件
    並且 我應該看到分頁控制項
    並且 分頁應該顯示總共 3 頁

  場景: 變更每頁顯示筆數
    假設 資料庫中存在 50 筆申報案件
    當 我在案件列表頁面
    並且 我將每頁顯示筆數改為 50
    那麼 應該顯示所有 50 筆案件
    並且 分頁應該顯示總共 1 頁

  場景: 切換分頁
    假設 資料庫中存在 50 筆申報案件
    當 我在案件列表頁面
    並且 我點擊第 2 頁
    那麼 應該顯示第 21-40 筆案件

  # =============================================================================
  # 快速篩選
  # =============================================================================

  @quick-filter
  場景: 快速篩選 - 我的草稿案件
    當 我在案件列表頁面
    並且 我點擊快速篩選 "我的草稿"
    那麼 查詢結果應該只包含我建立的草稿案件

  場景: 快速篩選 - 待處理案件
    當 我在案件列表頁面
    並且 我點擊快速篩選 "待處理"
    那麼 查詢結果應該包含狀態為 "草稿" 或 "補件中" 的案件

  場景: 快速篩選 - 已核准案件
    當 我在案件列表頁面
    並且 我點擊快速篩選 "已核准"
    那麼 查詢結果應該只包含狀態為 "核准" 的案件

  場景: 快速篩選 - 本週建立
    當 我在案件列表頁面
    並且 我點擊快速篩選 "本週建立"
    那麼 查詢結果應該只包含本週建立的案件

  # =============================================================================
  # 清除篩選
  # =============================================================================

  場景: 清除所有篩選條件
    當 我在案件列表頁面
    並且 我設定多個篩選條件
    並且 我點擊 "清除篩選" 按鈕
    那麼 所有篩選條件應該被清除
    並且 應該顯示所有案件

  場景: 查詢無結果
    當 我在案件列表頁面
    並且 我在搜尋欄輸入案件編號 "NOTEXIST"
    並且 我點擊搜尋按鈕
    那麼 我應該看到訊息 "查無符合條件的案件"
    並且 應該提供清除篩選的選項
