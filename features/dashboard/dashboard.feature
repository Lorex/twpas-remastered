# language: zh-TW
@dashboard
功能: 系統儀表板
  作為一個系統使用者
  我想要能夠在儀表板看到各類統計資料
  以便快速了解案件處理狀況

  背景:
    假設 我已經登入為 "doctor01"
    並且 資料庫中存在以下申報案件:
      | 狀態     | 數量 | 本月新增 |
      | 草稿     | 15   | 5        |
      | 待審核   | 8    | 3        |
      | 審核中   | 4    | 2        |
      | 核准     | 120  | 12       |
      | 駁回     | 10   | 1        |
      | 補件中   | 3    | 1        |

  # =============================================================================
  # 統計卡片
  # =============================================================================

  @statistics
  場景: 顯示案件狀態統計卡片
    當 我在儀表板頁面
    那麼 我應該看到以下統計卡片:
      | 標題       | 數值 |
      | 草稿案件   | 15   |
      | 待審核     | 8    |
      | 審核中     | 4    |
      | 已核准     | 120  |
      | 已駁回     | 10   |
      | 補件中     | 3    |

  場景: 顯示本月新增案件統計
    當 我在儀表板頁面
    那麼 我應該看到本月新增案件數量
    並且 數量應該為 24 筆

  場景: 顯示待處理案件提醒
    當 我在儀表板頁面
    那麼 我應該看到待處理案件區塊
    並且 待處理案件應該包含:
      | 類型     | 數量 |
      | 草稿     | 15   |
      | 補件中   | 3    |

  場景: 點擊統計卡片跳轉到對應列表
    當 我在儀表板頁面
    並且 我點擊 "草稿案件" 卡片
    那麼 我應該被導向案件列表頁面
    並且 列表應該已篩選狀態為 "草稿"

  # =============================================================================
  # 圖表
  # =============================================================================

  @charts
  場景: 顯示案件狀態分布圓餅圖
    當 我在儀表板頁面
    那麼 我應該看到案件狀態分布圓餅圖
    並且 圖表應該顯示各狀態的比例

  場景: 顯示案件趨勢折線圖
    當 我在儀表板頁面
    那麼 我應該看到案件趨勢折線圖
    並且 圖表應該顯示過去 6 個月的案件數量變化

  場景: 顯示案件類別分布長條圖
    當 我在儀表板頁面
    那麼 我應該看到案件類別分布長條圖
    並且 圖表應該按案件類別顯示數量

  場景: 切換圖表時間範圍
    當 我在儀表板頁面
    並且 我在案件趨勢圖表選擇時間範圍為 "過去 12 個月"
    那麼 圖表應該更新顯示過去 12 個月的資料

  # =============================================================================
  # 最近案件
  # =============================================================================

  @recent
  場景: 顯示最近建立的案件
    當 我在儀表板頁面
    那麼 我應該看到 "最近案件" 區塊
    並且 應該顯示最近 5 筆建立的案件
    並且 每筆案件應該顯示:
      | 欄位       |
      | 案件編號   |
      | 病人姓名   |
      | 申報類別   |
      | 狀態       |
      | 建立時間   |

  場景: 點擊最近案件跳轉到詳情
    當 我在儀表板頁面
    並且 我點擊最近案件列表中的一筆案件
    那麼 我應該被導向該案件的詳情頁面

  # =============================================================================
  # 快速操作
  # =============================================================================

  @quick-actions
  場景: 顯示快速操作按鈕
    當 我在儀表板頁面
    那麼 我應該看到以下快速操作按鈕:
      | 按鈕         |
      | 新增案件     |
      | 新增病人     |
      | 查詢案件     |

  場景: 點擊新增案件按鈕
    當 我在儀表板頁面
    並且 我點擊 "新增案件" 按鈕
    那麼 我應該被導向新增案件頁面

  場景: 點擊新增病人按鈕
    當 我在儀表板頁面
    並且 我點擊 "新增病人" 按鈕
    那麼 我應該被導向新增病人頁面

  # =============================================================================
  # 通知與提醒
  # =============================================================================

  @notifications
  場景: 顯示即將到期的案件提醒
    假設 有案件將在 7 天內到期
    當 我在儀表板頁面
    那麼 我應該看到 "即將到期" 提醒區塊
    並且 區塊應該顯示即將到期的案件列表

  場景: 顯示審查結果通知
    假設 有案件剛收到審查結果
    當 我在儀表板頁面
    那麼 我應該看到新的通知提示
    並且 通知應該包含審查結果摘要

  場景: 顯示補件提醒
    假設 有案件需要補件
    當 我在儀表板頁面
    那麼 我應該看到 "需要補件" 提醒
    並且 提醒應該包含補件期限

  # =============================================================================
  # 篩選與期間
  # =============================================================================

  @filters
  場景: 選擇統計期間
    當 我在儀表板頁面
    並且 我選擇期間為 "本季"
    那麼 所有統計數據應該更新為本季的資料

  場景: 選擇統計期間 - 自訂範圍
    當 我在儀表板頁面
    並且 我選擇期間為 "自訂"
    並且 我設定日期範圍為 "2024-01-01" 到 "2024-03-31"
    那麼 所有統計數據應該更新為該範圍的資料

  場景: 依案件類別篩選統計
    當 我在儀表板頁面
    並且 我選擇案件類別篩選為 "癌症標靶治療"
    那麼 所有統計數據應該只包含該類別的案件

  # =============================================================================
  # 響應式設計
  # =============================================================================

  @responsive
  場景: 桌面版面配置
    假設 我使用桌面瀏覽器 (寬度 > 1024px)
    當 我在儀表板頁面
    那麼 統計卡片應該以網格排列
    並且 每行應該顯示 4 個卡片

  場景: 平板版面配置
    假設 我使用平板裝置 (寬度 768-1024px)
    當 我在儀表板頁面
    那麼 統計卡片應該每行顯示 2 個

  場景: 手機版面配置
    假設 我使用手機裝置 (寬度 < 768px)
    當 我在儀表板頁面
    那麼 統計卡片應該垂直堆疊
    並且 圖表應該可以左右滑動查看

  # =============================================================================
  # 資料刷新
  # =============================================================================

  @refresh
  場景: 手動刷新儀表板資料
    當 我在儀表板頁面
    並且 我點擊刷新按鈕
    那麼 所有統計數據應該重新載入
    並且 應該顯示 "資料已更新" 訊息

  場景: 自動定期刷新
    假設 儀表板設定為每 5 分鐘自動刷新
    當 我在儀表板頁面停留超過 5 分鐘
    那麼 統計數據應該自動更新
